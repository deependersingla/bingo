<head>
<style type="text/css">
#portfolios {
    margin-left:auto; 
    margin-right:auto;
  }
  .btn-custom {
  background-color: hsl(195, 60%, 35%) !important;
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#2d95b7", endColorstr="#23748e");
  background-image: -khtml-gradient(linear, left top, left bottom, from(#2d95b7), to(#23748e));
  background-image: -moz-linear-gradient(top, #2d95b7, #23748e);
  background-image: -ms-linear-gradient(top, #2d95b7, #23748e);
  background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #2d95b7), color-stop(100%, #23748e));
  background-image: -webkit-linear-gradient(top, #2d95b7, #23748e);
  background-image: -o-linear-gradient(top, #2d95b7, #23748e);
  background-image: linear-gradient(#2d95b7, #23748e);
  border-color: #23748e #23748e hsl(195, 60%, 32.5%);
  color: #fff !important;
  text-shadow: 0 -1px 0 
  rgba(0, 0, 0, 0.16);
  -webkit-font-smoothing: antialiased;
}
</style>
</head>

  <body>
 <h3> <center>BINGO!</center></h3>
<% d = ComputerPlay.new(@matrix) %>
<%cut_line = d.total_cut_lines %>
<% # change this to 7 * 7  or 9 * 9%>


<% game = Game.where(user_id: current_user.id).last %>
<% comp_matrix = game.opponent_matrix %>
<% comp = ComputerPlay.new(comp_matrix) %>
<% cut_lines = comp.total_cut_lines %>


<% if cut_line < game.level && cut_lines < game.level %>

<% @matrix %>
<table id="portfolios" style="float:center;width:30%;" border="1" class="table table-bordered table-hover table-condensed" >

	<% @matrix.each do |z| %>
	<tr>
		<% z.each do |x| %>
		<th>
			<% if x == 0 %>
			<% x = "X" %>
			<% end %>
		<% if x == "X" %>
		<h3 style="color:red;">	<%= x%> </h3>
		<% else %>
		<h3 >	<%= x%> </h3>
		<% end %>
		</th>
		<% end %>
	</tr>
	<% end %>
</table>

<br>

<form action="/game/start_game" align="center">
<button class="sample btn custom large m" data-h="195" data-s="60" data-l="40", data-p="5" onclick="stopWatch()">Restart</button>

<% d = ['B','I','N','G','O'] %>
<% (0..cut_line - 1).each {|i| d[i] = "X"} %>
<h3><center>Your Score: <%= d[0..4] %></h3></center>

<% d = ['B','I','N','G','O'] %>
<% (0..cut_lines - 1).each {|i| d[i] = "X"} %>
<h3>Computer's Score: <%= d[0..4] %></h3>
</form>

<% elsif (cut_line >= game.level) && (cut_lines <game.level) %>
<% level = game.level + 2 %>
<% Game.new.game_initialization(current_user, level) %>
<% current_user.human_win += 1%>

<h1><center>YOU WIN</h1></center>

<h1><center>Human wins: <%= current_user.human_win %> </h1></center><br>
<h1><center>Computer wins: <%= current_user.computer_win %> </h1></center><br>
<h1><center>Tie: <%= current_user.tie %> </h1></center><br>
<form action="/game/start_game" align="center">
<button class="sample btn custom large m" data-h="195" data-s="60" data-l="40", data-p="5">Restart</button>
</form>
<form action="/game/play" align="center">
<button class="sample btn custom large m" data-h="195" data-s="60" data-l="40", data-p="5">Next Level</button>
</form>
<% elsif (cut_line >= game.level) && (cut_lines >=game.level) %>
<h1><center>TIE</h1></center>
<% current_user.tie +=1 %>
<% level = game.level %>
<% Game.new.game_initialization(current_user, level) %>

<h1><center>Human wins: <%= current_user.human_win %> </h1></center><br>
<h1><center>Computer wins: <%= current_user.computer_win %> </h1></center><br>
<h1><center>Tie: <%= current_user.tie %> </h1></center><br>
<form action="/game/play" align="center">
<button class="sample btn custom large m" data-h="195" data-s="60" data-l="40", data-p="5">Restart Level</button>
</form>

<% else %>
<h1><center>COMPUTER WINS</h1></center>
<% current_user.computer_win += 1 %>

<h1><center>Human wins: <%= current_user.human_win %> </h1></center><br>
<h1><center>Computer wins: <%= current_user.computer_win %> </h1></center><br>
<h1><center>Tie: <%= current_user.tie %> </h1></center><br>
<h1><center>Time taken: <%= game.stop %> </h1></center><br>

<form action="/game/start_game" align="center">
<button class="sample btn custom large m" data-h="195" data-s="60" data-l="40", data-p="5">Restart</button>
</form>
<% end %>
<% current_user.save %>
<div id="grad4" style="width:25%; height:100%; position:fixed; top:0px; left:70%;">
  <br>
  <br>
  <br>
 
</div>

<script language="javascript">

function stopWatch() {
window.alert("<%= game.stop=Time.now %>")
}
 
        var tbl = document.getElementById("portfolios");
        if (tbl != null) {
            for (var i = 0; i < tbl.rows.length; i++) {
                for (var j = 0; j < tbl.rows[i].cells.length; j++)
                    tbl.rows[i].cells[j].onclick = function () { getval(this); };
            }
        }
 
        function getval(cel) {
        	cel=cel.innerHTML.substring(8,11);
        	if(cel=='X   ')
        		{
        			window.alert("Oops! Click again.");

        		}
        		else {
              c="<% cut_line %>";
              

              post_to_url("/game/search", {q: cel});
        			
        		}
        }

		var post_to_url =  function (path, params, method) {
 		method = method || "post"; // Set method to post by default if not specified.

 // The rest of this code assumes you are not using a library.
 // It can be made less wordy if you use one.
 		var form = document.createElement("form");
 		form.setAttribute("method", method);
 		form.setAttribute("action", path);

 		for(var key in params) {
   		if(params.hasOwnProperty(key)) {
     		var hiddenField = document.createElement("input");
     		hiddenField.setAttribute("type", "hidden");
     		hiddenField.setAttribute("name", key);
     		hiddenField.setAttribute("value", params[key]);
 
     		form.appendChild(hiddenField);
        	}
  		}

   		document.body.appendChild(form);
   		form.submit();
		}

    </script>
<body>